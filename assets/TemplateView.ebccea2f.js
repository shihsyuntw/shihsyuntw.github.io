import{_ as L,a as A,i as O,r as N,e as q,w as z,o as E,g as U,h as m,j as l,k as n,n as G,p as T,F as R,c as M,J as j,q as i,s as J,t as f,v as x,l as P,z as H,N as K,m as w,A as Q,B as W}from"./index.96e8eb14.js";import{T as X}from"./TemplateTable.b71e27ec.js";const Y={components:{TemplateTable:X},setup(){const r=A(),o=O("appSettings"),_=N({loading:!1}),t=q(),p=N({cellValueRange:3,numRow:0,numColumn:0,templates:[],blobData:[]}),S=()=>{_.loading=!0,M({method:"GET",url:`${r.api_map_template}`}).then(function(e){p.templates=e.data.data.templates}).catch(function(e){console.log(e)}).finally(function(e){_.loading=!1})},g=e=>{const c=p.templates.indexOf(e);c!==-1&&p.templates.splice(c,1)},V=()=>{let e={key:Date.now(),name:"",type:"global",fab:o.value.fab,stage:o.value.stage,tableData:[]};for(let c=0;c<o.value.map_y;c++){const d={};for(let s=0;s<o.value.map_x;s++)d[`col${s}`]=0;e.tableData.push(d)}p.templates.push(e)},k=e=>{let c=[];for(let d in e){let s=e[d],v=[];for(let h of s.tableData){let y=[];for(let D in h)y.push(h[D]);v.push(y)}c.push({name:s.name,type:s.type,fab:s.fab,stage:s.stage,tableData:v})}return c},b=e=>{!e||e.validate(c=>{if(c){_.loading=!0,p.blobData=k(p.templates);const d=JSON.stringify(p);M({headers:{"Content-Type":"application/json"},method:"POST",url:`${r.api_map_template}`,data:d}).then(function(s){j({message:"Save success.",type:"success"})}).catch(function(s){j({message:s,type:"error"})}).then(()=>{_.loading=!1})}})};return z(o,e=>{p.numRow=o.value.map_x,p.numColumn=o.value.map_y}),E(()=>{S(),p.numRow=o.value.map_y,p.numColumn=o.value.map_x}),{appSettings:o,state:_,formRef:t,form:p,getTemplateList:S,removeTemplate:g,addTemplate:V,submitForm:b}}},C=r=>(Q("data-v-d857e0f7"),r=r(),W(),r),Z={class:"d-flex align-items-center mb-2"},$=C(()=>m("i",{class:"bx bx-child"},null,-1)),I=C(()=>m("label",{class:"fs-3 fw-bold text-dark"},[m("strong",null,"Template Settings")],-1)),ee=C(()=>m("hr",null,null,-1)),ae={class:"card-header2"},te={style:{"padding-top":"8px"}};function le(r,o,_,t,p,S){const g=i("el-button"),V=i("el-tag"),k=i("el-input"),b=i("el-form-item"),e=i("el-option"),c=i("el-option-group"),d=i("el-select"),s=i("TemplateTable"),v=i("el-card"),h=i("el-col"),y=i("el-row"),D=i("el-form"),F=J("loading");return f(),U(R,null,[m("div",Z,[$,I,l(g,{style:{"margin-left":"20px"},onClick:o[0]||(o[0]=a=>t.addTemplate())},{default:n(()=>[x("Add Template")]),_:1}),l(g,{type:"success",onClick:o[1]||(o[1]=a=>t.submitForm(t.formRef))},{default:n(()=>[x("Save")]),_:1})]),ee,G((f(),T(D,{ref:"formRef",model:t.form,"label-position":"top"},{default:n(()=>[l(y,{gutter:12},{default:n(()=>[(f(!0),U(R,null,P(t.form.templates,(a,B)=>(f(),T(h,{lg:8,key:a.key},{default:n(()=>[l(v,{class:"box-card"},{header:n(()=>[m("div",ae,[m("h4",te,H(a.name),1),t.appSettings.fab==a.fab&&t.appSettings.stage==a.stage?(f(),T(g,{key:0,type:"warning",onClick:K(u=>t.removeTemplate(a),["prevent"])},{default:n(()=>[x("Delete Template")]),_:2},1032,["onClick"])):w("",!0),a.fab=="DT"||a.stage=="DT"?(f(),T(V,{key:1,round:"",class:"mx-1",effect:"light",size:"large",type:"warning"},{default:n(()=>[x(" Built-in ")]),_:1})):w("",!0)])]),default:n(()=>[l(b,{label:"Template Name:",prop:"templates."+B+".name",rules:{required:!0,message:"Template name can not be null",trigger:"blur"}},{default:n(()=>[l(k,{modelValue:a.name,"onUpdate:modelValue":u=>a.name=u,disabled:t.appSettings.fab!=a.fab||t.appSettings.stage!=a.stage},null,8,["modelValue","onUpdate:modelValue","disabled"])]),_:2},1032,["prop"]),l(b,{label:"Type:",prop:"templates."+B+".type"},{default:n(()=>[l(d,{style:{width:"100%"},modelValue:a.type,"onUpdate:modelValue":u=>a.type=u,placeholder:"",disabled:t.appSettings.fab!=a.fab||t.appSettings.stage!=a.stage},{default:n(()=>[l(c,{label:"\u57FA\u65BC\u4F4D\u7F6E(Location-based Templates)"},{default:n(()=>[l(e,{label:"\u5168\u5C40\u5339\u914D (Global Matching)",value:"global"}),l(e,{label:"\u5C40\u90E8\u5339\u914D (Local Matching)  coming soon...",value:"single_local",disabled:""})]),_:1}),l(c,{label:"\u57FA\u65BC\u5F62\u72C0 (Shape-based Templates)"},{default:n(()=>[l(e,{label:"\u5340\u57DF\u5DEE\u7570\u6027\u6BD4\u5C0D (Local Differences Comparison) coming soon...",value:"local_abnormal",disabled:""}),l(e,{label:"\u7279\u5B9A\u6A23\u614B\u5339\u914D (Specific Pattern Matching)",value:"specific_pattern"})]),_:1})]),_:2},1032,["modelValue","onUpdate:modelValue","disabled"])]),_:2},1032,["prop"]),w("",!0),w("",!0),l(b,{style:{display:"flex","justify-content":"center"}},{default:n(()=>[l(s,{"column-number":t.appSettings.map_x,"column-min-weigth":15,"table-datas":a.tableData,allowedit:t.appSettings.fab==a.fab&&t.appSettings.stage==a.stage},null,8,["column-number","table-datas","allowedit"])]),_:2},1024)]),_:2},1024)]),_:2},1024))),128))]),_:1})]),_:1},8,["model"])),[[F,t.state.loading]])],64)}const se=L(Y,[["render",le],["__scopeId","data-v-d857e0f7"]]);export{se as default};
